<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>http2_header_hpack_visualizer</title>
</head>
<body>
<script>
const codeFontName = '"Noto Sans Mono", SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'
function create_textarea(label_text) {
    const label = document.createElement("label")
    label.textContent = label_text
    const textarea = document.createElement("textarea")
    textarea.setAttribute("cols",50)
    textarea.setAttribute("rows",15)
    textarea.style.display = "block"
    textarea.style.whiteSpace = "pre"
    textarea.style.fontFamily = codeFontName
    label.append(textarea)
    return [label,textarea]
}
function create_input(label_text) {
    const label = document.createElement("label")
    label.textContent = label_text
    label.style.display = "flex"
    const input = document.createElement("input")
    input.setAttribute("type","number")
    input.style.whiteSpace = "pre"
    input.style.fontFamily = codeFontName
    input.style.marginLeft = "2px"
    input.style.width = "16ch"
    label.append(input)
    return [label,input]
}
function horizontal_div(...children) {
    const div = document.createElement("div")
    div.style.display = "flex"
    div.style.gap = "10px"
    div.append(...children)
    return div
}
function div(...children) {
    const div = document.createElement("div")
    div.append(...children)
    return div
}
const [tablesize_label, tablesize_input] = create_input("SETTINGS_HEADER_TABLE_SIZE:")
tablesize_input.valueAsNumber = 4096
const [hex_label, hex_textarea] = create_textarea("HEX of Encoded Header list/Header Block Fragment")

function p(p_text,a_text) {
    const p_element = document.createElement("p")
    p_element.textContent = p_text
    if (a_text) {
        const a = document.createElement("a")
        a.textContent = a_text
        a.setAttribute("href",a_text)
        p_element.append(a)
    }
    return p_element
}

hex_label.addEventListener("paste",function handlePaste(e) {
    setTimeout(() => {
        calculate_output()
    }, 1)
})

function calculate_output() {
    const header_getter = create_header_getter(tablesize_input.valueAsNumber)
    for (const hex of hex_textarea.value.split("\n")) {
        header_getter.get_headersArr(fromHexString(hex))
    }
    output.textContent = header_getter.getOutput()
}

const output = document.createElement("pre")
output.style.fontFamily = codeFontName
output.style.fontSize = "16px"
output.style.lineHeight = "1.25"
output.style.color = "#dee2e6"
output.style.backgroundColor = "#212529"
output.style.width = "80ch"
output.style.boxSizing = "border-box"
output.textContent = ""

const examplesArr = [
    {
        name: "Literal Header Field with Indexing",
        tablesize: 256,
        hexarr: [
            "400a 6375 7374 6f6d 2d6b 6579 0d63 7573 746f 6d2d 6865 6164 6572",
        ],
    },
    {
        name: "Literal Header Field without Indexing",
        tablesize: 256,
        hexarr: [
            "040c 2f73 616d 706c 652f 7061 7468",
        ],
    },
    {
        name: "Literal Header Field Never Indexed",
        tablesize: 256,
        hexarr: [
            "1008 7061 7373 776f 7264 0673 6563 7265 74",
        ],
    },
    {
        name: "Indexed Header Field",
        tablesize: 256,
        hexarr: [
            "82",
        ],
    },
    {
        name: "Request Examples without Huffman Coding",
        tablesize: 256,
        hexarr: [
            "8286 8441 0f77 7777 2e65 7861 6d70 6c65 2e63 6f6d",
            "8286 84be 5808 6e6f 2d63 6163 6865",
            "8287 85bf 400a 6375 7374 6f6d 2d6b 6579 0c63 7573 746f 6d2d 7661 6c75 65",
        ],
    },
    {
        name: "Request Examples with Huffman Coding",
        tablesize: 256,
        hexarr: [
            "8286 8441 8cf1 e3c2 e5f2 3a6b a0ab 90f4 ff",
            "8286 84be 5886 a8eb 1064 9cbf",
            "8287 85bf 4088 25a8 49e9 5ba9 7d7f 8925 a849 e95b b8e8 b4bf",
        ],
    },
    {
        name: "Response Examples without Huffman Coding",
        tablesize: 256,
        hexarr: [
            "4803 3330 3258 0770 7269 7661 7465 611d 4d6f 6e2c 2032 3120 4f63 7420 3230 3133 2032 303a 3133 3a32 3120 474d 546e 1768 7474 7073 3a2f 2f77 7777 2e65 7861 6d70 6c65 2e63 6f6d",
            "4803 3330 37c1 c0bf",
            "88c1 611d 4d6f 6e2c 2032 3120 4f63 7420 3230 3133 2032 303a 3133 3a32 3220 474d 54c0 5a04 677a 6970 7738 666f 6f3d 4153 444a 4b48 514b 425a 584f 5157 454f 5049 5541 5851 5745 4f49 553b 206d 6178 2d61 6765 3d33 3630 303b 2076 6572 7369 6f6e 3d31",
        ],
    },
    {
        name: "Response Examples with Huffman Coding",
        tablesize: 256,
        hexarr: [
            "4882 6402 5885 aec3 771a 4b61 96d0 7abe 9410 54d4 44a8 2005 9504 0b81 66e0 82a6 2d1b ff6e 919d 29ad 1718 63c7 8f0b 97c8 e9ae 82ae 43d3",
            "4883 640e ffc1 c0bf",
            "88c1 6196 d07a be94 1054 d444 a820 0595 040b 8166 e084 a62d 1bff c05a 839b d9ab 77ad 94e7 821d d7f2 e6c7 b335 dfdf cd5b 3960 d5af 2708 7f36 72c1 ab27 0fb5 291f 9587 3160 65c0 03ed 4ee5 b106 3d50 07",
        ],
    },
]

const buttons = examplesArr.map(({name, tablesize, hexarr})=>{
    const button = document.createElement("button")
    button.style.display = "block"
    button.style.fontFamily = codeFontName

    button.style.fontSize = "16px"
    button.style.lineHeight = "1.25"

    button.textContent = name
    button.addEventListener("click",()=>{
        tablesize_input.valueAsNumber = tablesize
        hex_textarea.value = hexarr.join("\n")
        calculate_output()
    })
    return button
})

document.body.append(horizontal_div(div(tablesize_label, hex_label,
p("only pasting is supported, incremental typing is not supported"),
p("to decode multiple requests/responses (supports dynamic table), separate each request's hex by a newline"),
p("HPACK: Header Compression for HTTP/2: ","https://datatracker.ietf.org/doc/html/rfc7541"),
p("Examples:"),
...buttons
),
output
))


const static_table = [
    [],
    [":authority",""],
    [":method","GET"],
    [":method","POST"],
    [":path","/"],
    [":path","/index.html"],
    [":scheme","http"],
    [":scheme","https"],
    [":status","200"],
    [":status","204"],
    [":status","206"],
    [":status","304"],
    [":status","400"],
    [":status","404"],
    [":status","500"],
    ["accept-charset",""],
    ["accept-encoding","gzip, deflate"],
    ["accept-language",""],
    ["accept-ranges",""],
    ["accept",""],
    ["access-control-allow-origin",""],
    ["age",""],
    ["allow",""],
    ["authorization",""],
    ["cache-control",""],
    ["content-disposition",""],
    ["content-encoding",""],
    ["content-language",""],
    ["content-length",""],
    ["content-location",""],
    ["content-range",""],
    ["content-type",""],
    ["cookie",""],
    ["date",""],
    ["etag",""],
    ["expect",""],
    ["expires",""],
    ["from",""],
    ["host",""],
    ["if-match",""],
    ["if-modified-since",""],
    ["if-none-match",""],
    ["if-range",""],
    ["if-unmodified-since",""],
    ["last-modified",""],
    ["link",""],
    ["location",""],
    ["max-forwards",""],
    ["proxy-authenticate",""],
    ["proxy-authorization",""],
    ["range",""],
    ["referer",""],
    ["refresh",""],
    ["retry-after",""],
    ["server",""],
    ["set-cookie",""],
    ["strict-transport-security",""],
    ["transfer-encoding",""],
    ["user-agent",""],
    ["vary",""],
    ["via",""],
    ["www-authenticate",""],
]

const dst = new Uint8Array(65536)
const state_table = Uint16Array.from([64,80,112,128,176,192,256,304,400,448,512,560,672,784,912,1024,0,0,0,0,0,0,0,0,0,0,208,224,272,288,320,336,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,0,0,0,0,0,0,0,0,0,0,0,0,32,144,368,640,32,144,368,640,16,352,16,352,16,352,16,352,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,416,432,464,480,528,544,576,592,688,736,800,848,928,976,1040,1088,0,0,0,0,0,0,0,0,0,0,0,0,0,0,608,624,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,16,352,16,352,16,352,0,0,0,0,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,16,352,16,352,16,352,16,352,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,704,720,752,768,816,832,864,880,944,960,992,1008,1056,1072,1104,1152,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,0,0,0,0,0,0,0,0,0,0,0,0,1120,1136,1168,1184,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,16,352,0,0,0,0,0,0,1200,1248,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,16,352,16,352,16,352,1216,1232,1264,1296,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,0,0,0,0,0,1280,1312,1344,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,16,352,16,352,0,0,0,1328,1360,1408,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,16,352,16,352,16,352,0,0,1376,1392,1424,1440,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,16,352,16,352,0,0,0,0,0,0,1456,1472,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,16,352,16,352,16,352,0,0,1488,1504,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,16,352,16,352,0,0,0,1520,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,16,352,16,352,16,352,1536,1760,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,1552,1616,1776,2128,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,1568,1584,1632,1680,1792,1904,2144,2448,0,0,0,1600,1648,1664,1696,1712,1808,1856,1920,2016,2160,2272,2464,2704,16,352,16,352,16,352,0,0,0,0,0,0,0,0,1728,1744,32,144,368,640,32,144,368,640,32,144,368,640,16,352,16,352,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,16,352,16,352,16,352,0,0,0,0,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,16,352,16,352,16,352,16,352,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,1824,1840,1872,1888,1936,1968,2032,2080,2176,2224,2288,2336,2480,2592,2720,2880,0,0,0,0,0,0,0,0,0,1952,1984,2000,2048,2064,2096,2112,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,144,368,640,16,352,16,352,16,352,16,352,16,352,16,352,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,2192,2208,2240,2256,2304,2320,2352,2400,2496,2544,2608,2656,2736,2784,2896,3040,0,0,0,0,0,0,0,0,0,0,0,0,2368,2384,2416,2432,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,16,352,0,0,0,0,0,0,0,0,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,2512,2528,2560,2576,2624,2640,2672,2688,2752,2768,2800,2832,2912,2960,3056,3312,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,0,0,0,0,0,2816,2848,2864,2928,2944,2976,2992,3072,3184,3328,3568,16,352,16,352,16,352,16,352,16,352,0,0,0,0,0,0,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,16,352,16,352,16,352,16,352,16,352,16,352,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,0,0,0,0,0,0,3008,3024,3088,3136,3200,3248,3344,3456,3584,3808,16,352,16,352,16,352,16,352,16,352,16,352,0,0,0,0,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,16,352,16,352,16,352,16,352,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,3104,3120,3152,3168,3216,3232,3264,3280,3360,3408,3472,3520,3600,3696,3824,3936,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3296,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,16,352,16,352,16,352,16,352,0,0,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,16,352,16,352,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,3376,3392,3424,3440,3488,3504,3536,3552,3616,3648,3712,3760,3840,3888,3952,4000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,0,3632,3664,3680,3728,3744,3776,3792,3856,3872,3904,3920,3968,3984,4016,4032,16,352,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,144,368,640,16,352,16,352,16,352,16,352,16,352,16,352,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4048,16,352,16,352,16,352,16,352,16,352,16,352,16,352,16,352,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,16,352,16,352,16,352,16,352,4064,4080,32,144,368,640,32,144,368,640,32,144,368,640,32,144,368,640,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,32,144,368,640,32,144,368,640,32,144,368,640,0,0,0,0,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,16,352,16,352,16,352,0,0,32,144,368,640,32,144,368,640,32,144,368,640,0,0,0,0,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,48,96,160,240,384,496,656,896,0,0,0,0,0,0,0,0])
const sym_table = Uint8Array.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,48,49,50,97,99,101,105,111,115,116,0,0,0,0,0,0,48,48,49,49,50,50,97,97,99,99,101,101,105,105,111,111,48,48,48,48,49,49,49,49,50,50,50,50,97,97,97,97,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,97,97,97,97,97,97,97,97,99,99,99,99,101,101,101,101,105,105,105,105,111,111,111,111,99,99,99,99,99,99,99,99,101,101,101,101,101,101,101,101,105,105,105,105,105,105,105,105,111,111,111,111,111,111,111,111,115,115,116,116,32,37,45,46,47,51,52,53,54,55,56,57,115,115,115,115,116,116,116,116,32,32,37,37,45,45,46,46,115,115,115,115,115,115,115,115,116,116,116,116,116,116,116,116,32,32,32,32,37,37,37,37,45,45,45,45,46,46,46,46,32,32,32,32,32,32,32,32,37,37,37,37,37,37,37,37,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,47,47,51,51,52,52,53,53,54,54,55,55,56,56,57,57,47,47,47,47,51,51,51,51,52,52,52,52,53,53,53,53,47,47,47,47,47,47,47,47,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,54,54,54,54,55,55,55,55,56,56,56,56,57,57,57,57,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,61,65,95,98,100,102,103,104,108,109,110,112,114,117,0,0,61,61,65,65,95,95,98,98,100,100,102,102,103,103,104,104,61,61,61,61,65,65,65,65,95,95,95,95,98,98,98,98,61,61,61,61,61,61,61,61,65,65,65,65,65,65,65,65,95,95,95,95,95,95,95,95,98,98,98,98,98,98,98,98,100,100,100,100,102,102,102,102,103,103,103,103,104,104,104,104,100,100,100,100,100,100,100,100,102,102,102,102,102,102,102,102,103,103,103,103,103,103,103,103,104,104,104,104,104,104,104,104,108,108,109,109,110,110,112,112,114,114,117,117,58,66,67,68,108,108,108,108,109,109,109,109,110,110,110,110,112,112,112,112,108,108,108,108,108,108,108,108,109,109,109,109,109,109,109,109,110,110,110,110,110,110,110,110,112,112,112,112,112,112,112,112,114,114,114,114,117,117,117,117,58,58,66,66,67,67,68,68,114,114,114,114,114,114,114,114,117,117,117,117,117,117,117,117,58,58,58,58,66,66,66,66,67,67,67,67,68,68,68,68,58,58,58,58,58,58,58,58,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,69,69,70,70,71,71,72,72,73,73,74,74,75,75,76,76,69,69,69,69,70,70,70,70,71,71,71,71,72,72,72,72,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,73,73,73,73,74,74,74,74,75,75,75,75,76,76,76,76,73,73,73,73,73,73,73,73,74,74,74,74,74,74,74,74,75,75,75,75,75,75,75,75,76,76,76,76,76,76,76,76,77,77,78,78,79,79,80,80,81,81,82,82,83,83,84,84,77,77,77,77,78,78,78,78,79,79,79,79,80,80,80,80,77,77,77,77,77,77,77,77,78,78,78,78,78,78,78,78,79,79,79,79,79,79,79,79,80,80,80,80,80,80,80,80,81,81,81,81,82,82,82,82,83,83,83,83,84,84,84,84,81,81,81,81,81,81,81,81,82,82,82,82,82,82,82,82,83,83,83,83,83,83,83,83,84,84,84,84,84,84,84,84,85,86,87,89,106,107,113,118,119,120,121,122,0,0,0,0,85,85,86,86,87,87,89,89,106,106,107,107,113,113,118,118,85,85,85,85,86,86,86,86,87,87,87,87,89,89,89,89,85,85,85,85,85,85,85,85,86,86,86,86,86,86,86,86,87,87,87,87,87,87,87,87,89,89,89,89,89,89,89,89,106,106,106,106,107,107,107,107,113,113,113,113,118,118,118,118,106,106,106,106,106,106,106,106,107,107,107,107,107,107,107,107,113,113,113,113,113,113,113,113,118,118,118,118,118,118,118,118,119,119,120,120,121,121,122,122,38,42,44,59,88,90,0,0,119,119,119,119,120,120,120,120,121,121,121,121,122,122,122,122,119,119,119,119,119,119,119,119,120,120,120,120,120,120,120,120,121,121,121,121,121,121,121,121,122,122,122,122,122,122,122,122,38,38,42,42,44,44,59,59,88,88,90,90,0,0,0,0,38,38,38,38,42,42,42,42,44,44,44,44,59,59,59,59,38,38,38,38,38,38,38,38,42,42,42,42,42,42,42,42,44,44,44,44,44,44,44,44,59,59,59,59,59,59,59,59,88,88,88,88,90,90,90,90,33,34,40,41,63,0,0,0,88,88,88,88,88,88,88,88,90,90,90,90,90,90,90,90,33,33,34,34,40,40,41,41,63,63,39,43,124,0,0,0,33,33,33,33,34,34,34,34,40,40,40,40,41,41,41,41,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,63,63,63,63,39,39,43,43,124,124,35,62,0,0,0,0,63,63,63,63,63,63,63,63,39,39,39,39,43,43,43,43,39,39,39,39,39,39,39,39,43,43,43,43,43,43,43,43,124,124,124,124,35,35,62,62,0,36,64,91,93,126,0,0,124,124,124,124,124,124,124,124,35,35,35,35,62,62,62,62,35,35,35,35,35,35,35,35,62,62,62,62,62,62,62,62,0,0,36,36,64,64,91,91,93,93,126,126,94,125,0,0,0,0,0,0,36,36,36,36,64,64,64,64,91,91,91,91,0,0,0,0,0,0,0,0,36,36,36,36,36,36,36,36,64,64,64,64,64,64,64,64,91,91,91,91,91,91,91,91,93,93,93,93,126,126,126,126,94,94,125,125,60,96,123,0,93,93,93,93,93,93,93,93,126,126,126,126,126,126,126,126,94,94,94,94,125,125,125,125,60,60,96,96,123,123,0,0,94,94,94,94,94,94,94,94,125,125,125,125,125,125,125,125,60,60,60,60,96,96,96,96,123,123,123,123,0,0,0,0,60,60,60,60,60,60,60,60,96,96,96,96,96,96,96,96,123,123,123,123,123,123,123,123,0,0,0,0,0,0,0,0,92,195,208,0,0,0,0,0,0,0,0,0,0,0,0,0,92,92,195,195,208,208,128,130,131,162,184,194,224,226,0,0,92,92,92,92,195,195,195,195,208,208,208,208,128,128,130,130,92,92,92,92,92,92,92,92,195,195,195,195,195,195,195,195,208,208,208,208,208,208,208,208,128,128,128,128,130,130,130,130,128,128,128,128,128,128,128,128,130,130,130,130,130,130,130,130,131,131,162,162,184,184,194,194,224,224,226,226,153,161,167,172,131,131,131,131,162,162,162,162,184,184,184,184,194,194,194,194,131,131,131,131,131,131,131,131,162,162,162,162,162,162,162,162,184,184,184,184,184,184,184,184,194,194,194,194,194,194,194,194,224,224,224,224,226,226,226,226,153,153,161,161,167,167,172,172,224,224,224,224,224,224,224,224,226,226,226,226,226,226,226,226,153,153,153,153,161,161,161,161,167,167,167,167,172,172,172,172,153,153,153,153,153,153,153,153,161,161,161,161,161,161,161,161,167,167,167,167,167,167,167,167,172,172,172,172,172,172,172,172,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,176,177,179,209,216,217,227,229,230,0,0,0,0,0,0,0,176,176,177,177,179,179,209,209,216,216,217,217,227,227,229,229,176,176,176,176,177,177,177,177,179,179,179,179,209,209,209,209,176,176,176,176,176,176,176,176,177,177,177,177,177,177,177,177,179,179,179,179,179,179,179,179,209,209,209,209,209,209,209,209,216,216,216,216,217,217,217,217,227,227,227,227,229,229,229,229,216,216,216,216,216,216,216,216,217,217,217,217,217,217,217,217,227,227,227,227,227,227,227,227,229,229,229,229,229,229,229,229,230,230,129,132,133,134,136,146,154,156,160,163,164,169,170,173,230,230,230,230,129,129,132,132,133,133,134,134,136,136,146,146,230,230,230,230,230,230,230,230,129,129,129,129,132,132,132,132,129,129,129,129,129,129,129,129,132,132,132,132,132,132,132,132,133,133,133,133,134,134,134,134,136,136,136,136,146,146,146,146,133,133,133,133,133,133,133,133,134,134,134,134,134,134,134,134,136,136,136,136,136,136,136,136,146,146,146,146,146,146,146,146,154,154,156,156,160,160,163,163,164,164,169,169,170,170,173,173,154,154,154,154,156,156,156,156,160,160,160,160,163,163,163,163,154,154,154,154,154,154,154,154,156,156,156,156,156,156,156,156,160,160,160,160,160,160,160,160,163,163,163,163,163,163,163,163,164,164,164,164,169,169,169,169,170,170,170,170,173,173,173,173,164,164,164,164,164,164,164,164,169,169,169,169,169,169,169,169,170,170,170,170,170,170,170,170,173,173,173,173,173,173,173,173,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,178,181,185,186,187,189,190,196,198,228,232,233,0,0,0,0,178,178,181,181,185,185,186,186,187,187,189,189,190,190,196,196,178,178,178,178,181,181,181,181,185,185,185,185,186,186,186,186,178,178,178,178,178,178,178,178,181,181,181,181,181,181,181,181,185,185,185,185,185,185,185,185,186,186,186,186,186,186,186,186,187,187,187,187,189,189,189,189,190,190,190,190,196,196,196,196,187,187,187,187,187,187,187,187,189,189,189,189,189,189,189,189,190,190,190,190,190,190,190,190,196,196,196,196,196,196,196,196,198,198,228,228,232,232,233,233,1,135,137,138,139,140,141,143,198,198,198,198,228,228,228,228,232,232,232,232,233,233,233,233,198,198,198,198,198,198,198,198,228,228,228,228,228,228,228,228,232,232,232,232,232,232,232,232,233,233,233,233,233,233,233,233,1,1,135,135,137,137,138,138,139,139,140,140,141,141,143,143,1,1,1,1,135,135,135,135,137,137,137,137,138,138,138,138,1,1,1,1,1,1,1,1,135,135,135,135,135,135,135,135,137,137,137,137,137,137,137,137,138,138,138,138,138,138,138,138,139,139,139,139,140,140,140,140,141,141,141,141,143,143,143,143,139,139,139,139,139,139,139,139,140,140,140,140,140,140,140,140,141,141,141,141,141,141,141,141,143,143,143,143,143,143,143,143,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,147,149,150,151,152,155,157,158,165,166,168,174,175,180,182,183,147,147,149,149,150,150,151,151,152,152,155,155,157,157,158,158,147,147,147,147,149,149,149,149,150,150,150,150,151,151,151,151,147,147,147,147,147,147,147,147,149,149,149,149,149,149,149,149,150,150,150,150,150,150,150,150,151,151,151,151,151,151,151,151,152,152,152,152,155,155,155,155,157,157,157,157,158,158,158,158,152,152,152,152,152,152,152,152,155,155,155,155,155,155,155,155,157,157,157,157,157,157,157,157,158,158,158,158,158,158,158,158,165,165,166,166,168,168,174,174,175,175,180,180,182,182,183,183,165,165,165,165,166,166,166,166,168,168,168,168,174,174,174,174,165,165,165,165,165,165,165,165,166,166,166,166,166,166,166,166,168,168,168,168,168,168,168,168,174,174,174,174,174,174,174,174,175,175,175,175,180,180,180,180,182,182,182,182,183,183,183,183,175,175,175,175,175,175,175,175,180,180,180,180,180,180,180,180,182,182,182,182,182,182,182,182,183,183,183,183,183,183,183,183,188,191,197,231,239,0,0,0,0,0,0,0,0,0,0,0,188,188,191,191,197,197,231,231,239,239,9,142,144,145,148,159,188,188,188,188,191,191,191,191,197,197,197,197,231,231,231,231,188,188,188,188,188,188,188,188,191,191,191,191,191,191,191,191,197,197,197,197,197,197,197,197,231,231,231,231,231,231,231,231,239,239,239,239,9,9,142,142,144,144,145,145,148,148,159,159,239,239,239,239,239,239,239,239,9,9,9,9,142,142,142,142,9,9,9,9,9,9,9,9,142,142,142,142,142,142,142,142,144,144,144,144,145,145,145,145,148,148,148,148,159,159,159,159,144,144,144,144,144,144,144,144,145,145,145,145,145,145,145,145,148,148,148,148,148,148,148,148,159,159,159,159,159,159,159,159,171,206,215,225,236,237,0,0,0,0,0,0,0,0,0,0,171,171,206,206,215,215,225,225,236,236,237,237,199,207,234,235,171,171,171,171,206,206,206,206,215,215,215,215,225,225,225,225,171,171,171,171,171,171,171,171,206,206,206,206,206,206,206,206,215,215,215,215,215,215,215,215,225,225,225,225,225,225,225,225,236,236,236,236,237,237,237,237,199,199,207,207,234,234,235,235,236,236,236,236,236,236,236,236,237,237,237,237,237,237,237,237,199,199,199,199,207,207,207,207,234,234,234,234,235,235,235,235,199,199,199,199,199,199,199,199,207,207,207,207,207,207,207,207,234,234,234,234,234,234,234,234,235,235,235,235,235,235,235,235,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,192,193,200,201,202,205,210,213,218,219,238,240,242,243,255,0,192,192,193,193,200,200,201,201,202,202,205,205,210,210,213,213,192,192,192,192,193,193,193,193,200,200,200,200,201,201,201,201,192,192,192,192,192,192,192,192,193,193,193,193,193,193,193,193,200,200,200,200,200,200,200,200,201,201,201,201,201,201,201,201,202,202,202,202,205,205,205,205,210,210,210,210,213,213,213,213,202,202,202,202,202,202,202,202,205,205,205,205,205,205,205,205,210,210,210,210,210,210,210,210,213,213,213,213,213,213,213,213,218,218,219,219,238,238,240,240,242,242,243,243,255,255,203,204,218,218,218,218,219,219,219,219,238,238,238,238,240,240,240,240,218,218,218,218,218,218,218,218,219,219,219,219,219,219,219,219,238,238,238,238,238,238,238,238,240,240,240,240,240,240,240,240,242,242,242,242,243,243,243,243,255,255,255,255,203,203,204,204,242,242,242,242,242,242,242,242,243,243,243,243,243,243,243,243,255,255,255,255,255,255,255,255,203,203,203,203,204,204,204,204,203,203,203,203,203,203,203,203,204,204,204,204,204,204,204,204,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,211,212,214,221,222,223,241,244,245,246,247,248,250,251,252,253,211,211,212,212,214,214,221,221,222,222,223,223,241,241,244,244,211,211,211,211,212,212,212,212,214,214,214,214,221,221,221,221,211,211,211,211,211,211,211,211,212,212,212,212,212,212,212,212,214,214,214,214,214,214,214,214,221,221,221,221,221,221,221,221,222,222,222,222,223,223,223,223,241,241,241,241,244,244,244,244,222,222,222,222,222,222,222,222,223,223,223,223,223,223,223,223,241,241,241,241,241,241,241,241,244,244,244,244,244,244,244,244,245,245,246,246,247,247,248,248,250,250,251,251,252,252,253,253,245,245,245,245,246,246,246,246,247,247,247,247,248,248,248,248,245,245,245,245,245,245,245,245,246,246,246,246,246,246,246,246,247,247,247,247,247,247,247,247,248,248,248,248,248,248,248,248,250,250,250,250,251,251,251,251,252,252,252,252,253,253,253,253,250,250,250,250,250,250,250,250,251,251,251,251,251,251,251,251,252,252,252,252,252,252,252,252,253,253,253,253,253,253,253,253,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,254,254,2,3,4,5,6,7,8,11,12,14,15,16,17,18,254,254,254,254,2,2,3,3,4,4,5,5,6,6,7,7,254,254,254,254,254,254,254,254,2,2,2,2,3,3,3,3,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,8,8,11,11,12,12,14,14,15,15,16,16,17,17,18,18,8,8,8,8,11,11,11,11,12,12,12,12,14,14,14,14,8,8,8,8,8,8,8,8,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,14,14,14,14,14,14,14,14,15,15,15,15,16,16,16,16,17,17,17,17,18,18,18,18,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,19,20,21,23,24,25,26,27,28,29,30,31,127,220,249,0,19,19,20,20,21,21,23,23,24,24,25,25,26,26,27,27,19,19,19,19,20,20,20,20,21,21,21,21,23,23,23,23,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,23,23,23,23,23,23,23,23,24,24,24,24,25,25,25,25,26,26,26,26,27,27,27,27,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,28,28,29,29,30,30,31,31,127,127,220,220,249,249,0,0,28,28,28,28,29,29,29,29,30,30,30,30,31,31,31,31,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,127,127,127,127,220,220,220,220,249,249,249,249,10,13,22,0,127,127,127,127,127,127,127,127,220,220,220,220,220,220,220,220,249,249,249,249,249,249,249,249,10,10,13,13,22,22,0,0,10,10,10,10,13,13,13,13,22,22,22,22,0,0,0,0,10,10,10,10,10,10,10,10,13,13,13,13,13,13,13,13,22,22,22,22,22,22,22,22,0,0,0,0,0,0,0,0])
const hasSym_table = Uint8Array.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0])
function huffman_decode(src) {
    let state = 0, j = 0, idx
    for (let i = 0; i < src.length; ++i) {
        idx = state | (src[i] >> 4)
        if (hasSym_table[idx]) {
            dst[j] = sym_table[idx]
            ++j
        }
        state = state_table[idx]
        //repeat
        idx = state | (src[i] & 0xf)
        if (hasSym_table[idx]) {
            dst[j] = sym_table[idx]
            ++j
        }
        state = state_table[idx]
    }
    return new TextDecoder().decode(dst.subarray(0,j))
}

function createResizableCircularQueue(initialSize=32) {
    return {
        writeIdx:-1,
        used:0,
        arr:Array(initialSize),
        putInside(what) {
            if (this.used===this.arr.length) {
                const newArr = Array(this.arr.length*2)
                for (let i = 0; i <= this.writeIdx; ++i) {
                    newArr[i] = this.arr[i]
                }
                for (let i = this.arr.length - 1,j=newArr.length-1; i > this.writeIdx; --i, --j) {
                    newArr[j] = this.arr[i]
                }
                this.arr = newArr
            }

            ++this.writeIdx
            if (this.writeIdx===this.arr.length) {
                this.writeIdx=0
            }
            this.arr[this.writeIdx] = what
            ++this.used
        },
        getByIdxLastFirst(idx) {
            if (this.used) {
                let readIdx = this.writeIdx - idx
                if (readIdx < 0) {
                    readIdx+=this.arr.length
                }
                return this.arr[readIdx]
            } else {
                return undefined
            }
        },
        getFirstIn() {
            if (this.used) {
                --this.used
                let readIdx = this.writeIdx - this.used
                if (readIdx < 0) {
                    readIdx+=this.arr.length
                }
                const toReturn = this.arr[readIdx]
                return toReturn
            } else {
                return undefined
            }
        },
    }
}

function create_header_getter(SETTINGS_HEADER_TABLE_SIZE=4096) {
    const dynamic_table = createResizableCircularQueue(Math.trunc(SETTINGS_HEADER_TABLE_SIZE/33))
    let current_table_size = 0

    const printable = Object.fromEntries('0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~ '.split("").map(v=>[v.charCodeAt(0),v]))
    const output = []

    let req_count = 1

    function get_from_static_or_dynamic_table(idx) {
        if (idx < static_table.length) {
            return static_table[idx]
        } else {
            return dynamic_table.getByIdxLastFirst(idx - static_table.length)
        }
    }

    function add_to_dynamic_table([header_name,header_value]) {
        current_table_size+=32 + header_name.length + header_value.length
        while (current_table_size > SETTINGS_HEADER_TABLE_SIZE) {
            const [header_name,header_value] = dynamic_table.getFirstIn()
            print_print(`${" ".repeat(43)}| - evict: `,`\n${" ".repeat(43)}|   `,header_name,header_value)
            current_table_size-=32 + header_name.length + header_value.length
        }
        dynamic_table.putInside([header_name,header_value])
    }

    function hex_dump(frame_payload) {
        const dump_width = 16
        const padding = (((dump_width + 1) >> 1) << 1) + ((dump_width >> 1)*3)
        const toJoin = []
        let end
        for (let i = 0; i < frame_payload.length; i=end) {
            end = i+dump_width
            const sub_array = Array.from(frame_payload.subarray(i,end))
            toJoin.push(`  ${sub_array.map((v,i)=>`${(i&1 ? "": " ")}${v.toString(16).padStart(2,"0")}`).join("").padEnd(padding," ")} | ${sub_array.map(v=>(printable[v] ?? ".")).join("")}`)
        }
        output.push(toJoin.join("\n"))
    }

    function hex(int) {
        return int.toString(16).padStart(2,"0")
    }

    function print_print(startingValue,middleValue,header_name,header_value) {
        //print print
        let remaining = 71 - startingValue.length
        output.push(`\n${startingValue}`)
        function remaining_or_newline(str,space) {
            if (space.length + str.length <= remaining) {
                output.push(`${space}${str}`)
                remaining-=str.length
            } else if (str.length <= 24) {
                output.push(`${middleValue}${str}`)
                remaining=24 - str.length
            } else {
                str = remaining ? `${space}${str}` : str
                const arr = str.slice(remaining).match(/.{1,24}/g)
                output.push(str.slice(0,remaining))
                output.push(arr.map(v=>`${middleValue}${v}`).join(""))
                remaining=24 - arr[arr.length-1].length
            }
        }
        remaining_or_newline(`${header_name}:`,"")
        //for (const chunk of header_value.split(" ")) {
        //    remaining_or_newline(chunk," ")
        //}
        remaining_or_newline(header_value," ")
    }

    function get_headersArr(frame_payload) {
        ;output.length && output.push("\n\n");
        output.push(`Request/Response #${req_count}\n`); ++req_count
        output.push("   Hex dump of encoded data:\n\n")
        hex_dump(frame_payload)
        output.push("\n\n   Decoding process:\n")

        const headersArr = []
        let p = 0
        while (p < frame_payload.length) {
            const firstByte = frame_payload[p]
            let header_name,header_value
            ++p
            if (firstByte & 0x80) {
                output.push(`\n   ${hex(firstByte)}${" ".repeat(38)}| == Indexed - Add ==`)
                const idx = firstByte & 0x7f
                output.push(`\n${" ".repeat(43)}|   idx = ${idx}`)
                headersArr.push(([header_name,header_value] = get_from_static_or_dynamic_table(idx).slice()))
            } else if (firstByte & 0x40) {
                output.push(`\n   ${hex(firstByte)}${" ".repeat(38)}| == Literal indexed ==`)
                add_to_dynamic_table(([header_name,header_value] = common(firstByte & 0x3f)))
            } else {
                if (firstByte & 0x10) {
                    output.push(`\n   ${hex(firstByte)}${" ".repeat(38)}| == Literal never indexed ==`)
                } else {
                    output.push(`\n   ${hex(firstByte)}${" ".repeat(38)}| == Literal not indexed ==`)
                }
                [header_name,header_value] = common(firstByte & 0xf)
            }
            print_print(`${" ".repeat(43)}| -> `,`\n${" ".repeat(43)}|   `,header_name,header_value)
        }

        function common(idx) {
            let header_name
            if (idx) {
                header_name = get_from_static_or_dynamic_table(idx)[0]
                output.push(`\n${" ".repeat(43)}|   Indexed name (idx = ${idx})`)
                output.push(`\n${" ".repeat(43)}|     ${header_name}`)
            } else {
                header_name = read_string("name")
            }
            const header_value = read_string("value")

            headersArr.push([header_name,header_value])
            return [header_name,header_value]
        }

        function read_string(type) {
            const value_length = frame_payload[p]
            ++p
            let value_end, header_value
            let the_sub_array
            if (value_length & 0x80) {
                value_end = p + (value_length & 0x7f)
                the_sub_array = frame_payload.subarray(p, value_end)
                header_value = huffman_decode(the_sub_array)
            } else {
                value_end = p + value_length
                the_sub_array = frame_payload.subarray(p,value_end)
                header_value = new TextDecoder().decode(the_sub_array)
            }
            output.push(`\n   ${hex(value_length)}${" ".repeat(38)}|   Literal ${type} (len = ${value_end - p})\n`)
            if (value_length & 0x80) {
                output.push(`${" ".repeat(43)}|     Huffman encoded:\n`)
            }
            hex_dump(the_sub_array)
            if (value_length & 0x80) {
                output.push(`\n${" ".repeat(43)}|     Decoded:`)
                output.push(header_value.match(/.{1,26}/g).map(v=>`\n${" ".repeat(43)}| ${v}`).join(""))
            }
            p = value_end
            return header_value
        }

        if (current_table_size) {
            output.push(`\n\n   Dynamic Table (after decoding):\n`)
    
            for (let i = 0; i < dynamic_table.used; i++) {
                const [header_name,header_value] = dynamic_table.getByIdxLastFirst(i)
                output.push(`\n   [${(i+1).toString().padStart(3," ")}] (s =${(header_name.length+header_value.length+32).toString().padStart(4," ")}) `)
                if (header_name.length+header_value.length+2 <= 52) {
                    output.push(`${header_name}: ${header_value}`)
                } else if (header_name.length+1 <= 52) {
                    if (header_name.toLowerCase()==="set-cookie" || header_name.toLowerCase() === "cookie") {
                        let remaining = 52 - header_name.length - 2
                        output.push(`${header_name}:`)
                        const cookies = header_value.split("; ")
                        for (const [i, cookie] of cookies.entries()) {
                            const semicolon = (i===cookies.length - 1) ? "" : ";"
                            function remaining_or_newline(str,space) {
                                if (space.length + str.length <= remaining) {
                                    output.push(`${space}${str}`)
                                    remaining-=str.length
                                } else if (str.length <= 51) {
                                    output.push(`\n                    ${str}`)
                                    remaining=51 - str.length
                                } else {
                                    str = remaining ? `${space}${str}` : str
                                    const arr = str.slice(remaining).match(/.{1,51}/g)
                                    output.push(str.slice(0,remaining))
                                    output.push(arr.map(v=>`\n                    ${v}`).join(""))
                                    remaining=51 - arr[arr.length-1].length
                                }
                            }
                            const [cookie_name, cookie_value] = cookie.split("=")
                            remaining_or_newline(`${cookie_name}=`," ")
                            remaining_or_newline(`${cookie_value}${semicolon}`,"")
                        }
                    } else {
                        output.push(`${header_name}:${header_value.match(/.{1,51}/g).map(v=>`\n                    ${v}`).join("")}`)
                    }
                } else {
                    output.push(`${header_name.slice(0,52)}${`${header_name.slice(52)}: ${header_value}`.match(/.{1,51}/g).map(v=>`\n                    ${v}`).join("")}`)
                }
            }
            output.push(`\n         Table size:${current_table_size.toString().padStart(4," ")}`)
        } else {
            output.push(`\n\n   Dynamic Table (after decoding): empty`)
        }

        output.push(`\n\n   Decoded header list:\n`)

        output.push(headersArr.map(([header_name,header_value])=>`${header_name}: ${header_value}`.match(/.{1,71}/g).map(v=>`\n   ${v}`).join("")).join(""))

        return headersArr
    }
    function getOutput() {
        return output.join("")
    }
    return {
        get_headersArr,getOutput
    }
}


function fromHexString(hexString) {
    return Uint8Array.from(hexString.replace(/ /g,"").match(/.{2}/g).map(function(byte) {
        return parseInt(byte, 16)
    }))
}
</script>
</body>
</html>